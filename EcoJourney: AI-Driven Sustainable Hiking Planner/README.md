# EcoJourney: AI-Powered Sustainable Travel Planner Workflow

## Overview

EcoJourney is an automated workflow designed in n8n to provide eco-friendly hiking routes between two locations, estimate the carbon emissions, suggest carbon offset options, and generate real-time sustainability travel tips using AI. This workflow combines geospatial API calls with OpenAI's GPT-4 model to create a comprehensive sustainable travel planning experience.

---

## Workflow Nodes and Description

### 1. Start (HTTP Trigger)

- **Type:** HTTP Trigger
- **Purpose:** Entry point of the workflow that listens for HTTP GET requests on the `/start` path.
- **Response:** Immediately responds with the received JSON input.
- **Authentication:** None

### 2. Validate Input (Function)

- **Purpose:** Validates that the incoming request payload contains the required parameters: `origin` and `destination`.
- **Logic:** Checks if both `origin` and `destination` are present in the request JSON. Throws an error if missing.
- **Additional:** Passes optional `constraints` if provided.

### 3. Get Eco-friendly Route (HTTP Request)

- **Purpose:** Queries the OpenRouteService API for hiking directions between the origin and destination points.
- **API Endpoint:** `https://api.openrouteservice.org/v2/directions/foot-hiking`
- **Parameters:**
  - `start`: Longitude and latitude of the origin.
  - `end`: Longitude and latitude of the destination.
- **Authentication:** Uses OpenRouteService API key via header authorization.
- **Response:** JSON with route details optimized for hiking (eco-friendly).

### 4. Estimate Carbon Emissions (Function)

- **Purpose:** Calculates approximate carbon emissions based on the route distance.
- **Logic:** 
  - Extracts distance in meters from route data.
  - Converts distance to kilometers.
  - Assumes near-zero carbon emissions for foot-hiking.
  - Emits carbon emissions in grams (set to 0 for hiking).
  
### 5. Calculate Carbon Offset Options (Function)

- **Purpose:** Provides potential carbon offset options and estimated costs based on carbon emissions.
- **Logic:**
  - Carbon offset cost is calculated at $10 per ton of CO2.
  - Since hiking emits zero carbon, cost is zero.
  - Suggests offset options like tree planting and renewable energy credits along with estimated costs.

### 6. Get Sustainability Tips (HTTP Request)

- **Purpose:** Uses OpenAIâ€™s GPT-4 API to generate travel sustainability tips tailored for the planned trip.
- **API Endpoint:** `https://api.openai.com/v1/chat/completions`
- **Inputs:**
  - System role instructs to provide real-time sustainability travel tips.
  - User prompt includes origin and destination names.
- **Authentication:** Uses OpenAI API key via Bearer token.
- **Output:** Textual sustainability travel tips.

### 7. Assemble Response (Function)

- **Purpose:** Gathers and structures all collected data into one consolidated JSON response.
- **Includes:**
  - Origin and destination details.
  - Hiking route information.
  - Distance in kilometers.
  - Estimated carbon emissions.
  - Carbon offset options and costs.
  - AI-generated sustainability tips.

### 8. Respond (HTTP Response)

- **Purpose:** Sends the assembled response back to the requester as the final output.
- **Response Mode:** Outputs the JSON response from the previous node.

---

## Input Format

The HTTP trigger expects a JSON payload with the following structure:

```json
{
  "origin": {
    "latitude": <number>,
    "longitude": <number>,
    "name": "<optional string>"
  },
  "destination": {
    "latitude": <number>,
    "longitude": <number>,
    "name": "<optional string>"
  },
  "constraints": {
    // Optional travel constraints (custom usage)
  }
}
```

---

## Output Format

The workflow returns a JSON object containing:

- `origin`: Object with origin location info.
- `destination`: Object with destination location info.
- `route`: GeoJSON feature containing the hiking route.
- `distanceKm`: Approximate route distance in kilometers.
- `carbonEmissionsGrams`: Estimated carbon emissions (grams).
- `carbonOffsetOptions`: Array of offline options to offset emissions with descriptions and costs.
- `sustainabilityTips`: Textual tips generated by AI for eco-friendly travel.

Example:

```json
{
  "origin": { "latitude": 48.8588443, "longitude": 2.2943506, "name": "Eiffel Tower" },
  "destination": { "latitude": 48.8737926, "longitude": 2.2950285, "name": "Arc de Triomphe" },
  "route": { /* GeoJSON route data */ },
  "distanceKm": 2.1,
  "carbonEmissionsGrams": 0,
  "carbonOffsetOptions": [
    {
      "option": "Plant Trees",
      "description": "Purchase tree planting offsets to compensate carbon footprint.",
      "estimatedCostUSD": "0.0000"
    },
    {
      "option": "Renewable Energy Credits",
      "description": "Support renewable energy projects offsetting your travel carbon.",
      "estimatedCostUSD": "0.0000"
    }
  ],
  "sustainabilityTips": "To keep your trip eco-friendly, consider..."
}
```

---

## Credentials Setup

### OpenRouteService API

- Required to fetch hiking route directions.
- Obtain API key from [OpenRouteService](https://openrouteservice.org/dev/#/signup).
- Store in n8n credentials as `OpenRouteService API`.

### OpenAI API

- Required to generate sustainability travel tips.
- Obtain API key from [OpenAI](https://platform.openai.com/account/api-keys).
- Store in n8n credentials as `OpenAI API`.

---

## Usage

1. Deploy the workflow in n8n.
2. Set the OpenRouteService and OpenAI credentials in the credentials section.
3. Make a GET request to the `/start` endpoint with the necessary JSON payload.
4. Receive a response including eco-friendly hiking route, carbon emissions estimate, offset options, and sustainability tips.

---

## Notes

- Currently optimized for hiking (foot travel) with near-zero carbon emissions.
- Carbon offset cost calculations are placeholders for demonstration.
- Additional constraints can be added to enhance route customization.
- AI tips can be further tailored by modifying the system prompt or user message in the OpenAI node.