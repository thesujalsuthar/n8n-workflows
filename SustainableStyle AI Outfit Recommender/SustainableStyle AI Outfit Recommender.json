{
  "name": "AI-Powered Sustainable Fashion Outfit Recommender",
  "nodes": [
    {
      "parameters": {
        "authentication": "none",
        "url": "https://api.weatherapi.com/v1/current.json",
        "queryParametersUi": {
          "parameter": [
            {
              "name": "key",
              "value": "={{$env.WEATHER_API_KEY}}"
            },
            {
              "name": "q",
              "value": "={{$json.userLocation}}"
            }
          ]
        },
        "options": {}
      },
      "name": "Fetch Weather Data",
      "type": "httpRequest",
      "typeVersion": 1,
      "position": [
        250,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "return [\n  {\n    userPreferences: $json.userPreferences || {},\n    occasion: $json.occasion || \"casual\",\n    weather: $items(\"Fetch Weather Data\")[0].json.current,\n    ecoGuidelines: {\n      materials: [\"organic cotton\", \"recycled polyester\", \"linen\", \"hemp\"],\n      dyes: [\"natural\"],\n      certifications: [\"GOTS\", \"Fair Trade\", \"Bluesign\"]\n    }\n  }\n];"
      },
      "name": "Prepare Context Data",
      "type": "function",
      "typeVersion": 1,
      "position": [
        450,
        300
      ]
    },
    {
      "parameters": {
        "resource": "assistant",
        "operation": "chatCompletion",
        "model": "gpt-4o-mini",
        "messages": [
          {
            "role": "system",
            "content": "You are an AI stylist specialized in sustainable fashion. Based on user preferences, occasion, current weather conditions, and eco-friendly fashion guidelines, you provide personalized sustainable outfit recommendations. Each recommendation should include outfit components, sustainability score explanation, and links to recommended sustainable brands or products."
          },
          {
            "role": "user",
            "content": "User Preferences: {{$json.userPreferences}}\nOccasion: {{$json.occasion}}\nWeather: {{$json.weather.condition.text}}, Temp: {{$json.weather.temp_c}} Â°C\nEco Guidelines: Materials - {{$json.ecoGuidelines.materials.join(\", \")}}, Certifications - {{$json.ecoGuidelines.certifications.join(\", \")}}"
          }
        ],
        "options": {},
        "returnFullResponse": false
      },
      "name": "Generate Outfit Recommendations",
      "type": "openai",
      "typeVersion": 1,
      "position": [
        650,
        300
      ]
    },
    {
      "parameters": {
        "resource": "email",
        "operation": "send",
        "fromEmail": "no-reply@sustainablefashion.ai",
        "toEmail": "={{$json.userEmail}}",
        "subject": "Your Personalized Sustainable Outfit Recommendations",
        "text": "Hello,\n\nHere are your personalized sustainable fashion outfit recommendations based on your preferences and today's weather:\n\n{{$json.choices[0].message.content}}\n\nStay stylish and eco-friendly!\n\nSustainable Fashion AI Team"
      },
      "name": "Send Email Notification",
      "type": "emailSend",
      "typeVersion": 1,
      "position": [
        900,
        250
      ]
    },
    {
      "parameters": {
        "chatIdSource": "property",
        "chatId": "={{$json.userChatId}}",
        "text": "={{\"Hello! Here are your personalized sustainable outfit recommendations based on your preferences and today's weather:\\n\" + $json.choices[0].message.content}}"
      },
      "name": "Send Messaging Notification",
      "type": "telegram",
      "typeVersion": 1,
      "position": [
        900,
        350
      ]
    },
    {
      "parameters": {
        "functionCode": "return [\n  {\n    userPreferences: {\n      style: \"bohemian\",\n      colors: [\"earth tones\", \"green\", \"beige\"],\n      avoidedMaterials: [\"leather\", \"synthetic fibers\"]\n    },\n    occasion: \"weekend outing\",\n    userLocation: \"San Francisco\",\n    userEmail: \"user@example.com\",\n    userChatId: \"123456789\"\n  }\n];"
      },
      "name": "Set Test Input",
      "type": "function",
      "typeVersion": 1,
      "position": [
        50,
        300
      ]
    }
  ],
  "connections": {
    "Set Test Input": {
      "main": [
        [
          {
            "node": "Fetch Weather Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Weather Data": {
      "main": [
        [
          {
            "node": "Prepare Context Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Context Data": {
      "main": [
        [
          {
            "node": "Generate Outfit Recommendations",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Outfit Recommendations": {
      "main": [
        [
          {
            "node": "Send Email Notification",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send Messaging Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}