{
  "name": "AI-Powered Personalized Environmental Sustainability Tips & Habit Tracker",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "submit-user-data",
        "options": {},
        "responseMode": "lastNode",
        "responseData": "={{$json}}"
      },
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        250,
        300
      ],
      "webhookId": "AI_SUSTAINABILITY_TIPS_WEBHOOK"
    },
    {
      "parameters": {
        "functionCode": "const userData = $json;\n\n// Example userData structure expected:\n// { \"energyUsage\": 350, \"transportMethod\": \"car\", \"dietPreference\": \"omnivore\", \"recyclingHabit\": true, \"region\": \"CA\" }\n\n// Basic environmental data fetched earlier will be attached to input or can be fetched externally\n// Here mock environmental info (e.g., air quality, average regional emissions) is simulated\n\nreturn {\n  json: {\n    userData,\n    environmentalData: {\n      airQualityIndex: 75,\n      regionalCO2Emissions: 12.4\n    }\n  }\n};"
      },
      "name": "Prepare Data",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        500,
        300
      ]
    },
    {
      "parameters": {
        "model": "gpt-4",
        "prompt": "You are an AI assistant providing personalized environmental sustainability tips based on the following user information and environmental data:\n\nUser Data: {{ $json.userData }}\nEnvironmental Data: {{ $json.environmentalData }}\n\nPLEASE provide 3 practical, personalized, and actionable sustainability tips for this user, focused on reducing their environmental impact.\n\nFormat your output as JSON with the field \"tips\" containing an array of tip strings.\n",
        "temperature": 0.7,
        "maxTokens": 300,
        "topP": 1,
        "frequencyPenalty": 0,
        "presencePenalty": 0
      },
      "name": "Generate Sustainability Tips",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1,
      "position": [
        750,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const userData = $json.userData;\nconst environmentalData = $json.environmentalData;\nconst tipsData = JSON.parse($items(\"Generate Sustainability Tips\")[0].json.choices[0].message.content);\n\nconst tips = tipsData.tips;\n\n// Initialize or update user habit tracking data (in-memory for demo purpose)\n// In production, use database or external storage\n\nconst habitProgress = {\n  lastInput: userData,\n  tipsReceived: tips,\n  progressLog: [] // Could store date, habit, status\n};\n\nreturn { json: habitProgress };"
      },
      "name": "Track Habit Progress",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1000,
        300
      ]
    },
    {
      "parameters": {
        "text": "Hello! Here are your personalized environmental sustainability tips based on your input:\n\n{{$json.tipsReceived.map((tip, index) => (`${index + 1}. ${tip}`)).join('\\n')}}\n\nTrack your progress regularly to build sustainable habits and make an impactful change!"
      },
      "name": "Send Tips Response",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        1250,
        300
      ]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Prepare Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Data": {
      "main": [
        [
          {
            "node": "Generate Sustainability Tips",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Sustainability Tips": {
      "main": [
        [
          {
            "node": "Track Habit Progress",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Track Habit Progress": {
      "main": [
        [
          {
            "node": "Send Tips Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  ],
  "active": false,
  "settings": {},
  "id": "AI_Personalized_Sustainability_Tips_And_Tracker"
}