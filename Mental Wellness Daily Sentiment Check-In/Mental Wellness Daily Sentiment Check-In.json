{
  "nodes": [
    {
      "parameters": {
        "pollingInterval": 86400000,
        "triggerTimes": {
          "item": [
            {
              "hour": 9,
              "minute": 0
            }
          ]
        }
      },
      "name": "Daily Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [
        250,
        300
      ]
    },
    {
      "parameters": {
        "questions": [
          "How are you feeling today?",
          "Are you experiencing any stress or anxiety right now?",
          "On a scale from 1 to 10, how would you rate your current mood?",
          "Would you like some suggestions for coping strategies or self-care activities today?"
        ],
        "options": {
          "questionsType": "text"
        }
      },
      "name": "Mental Wellness Check-in Prompt",
      "type": "n8n-nodes-base.conversationalPrompt",
      "typeVersion": 1,
      "position": [
        500,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const responses = $json;\n\nconst combinedText = Object.values(responses).join(' ');\n\nreturn [{ json: { combinedText } }];"
      },
      "name": "Combine Responses",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        700,
        300
      ]
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "sentimentAnalysis",
        "model": "gpt-4o-mini",
        "inputText": "={{$json.combinedText}}",
        "options": {}
      },
      "name": "AI Sentiment Analysis",
      "type": "n8n-nodes-base.openai",
      "typeVersion": 1,
      "position": [
        900,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const sentiment = $json.sentiment || {};\nconst positive = sentiment.positive || 0;\nconst negative = sentiment.negative || 0;\nconst mixed = sentiment.mixed || 0;\nconst overallScore = sentiment.score || 0;\n\nconst stressOrAnxietyDetected = (negative > 0.5) || overallScore < -0.2;\nconst lowMood = overallScore < -0.3;\n\nlet copingSuggestions = [];\n\nif (stressOrAnxietyDetected) {\n  copingSuggestions.push('Try deep breathing exercises or mindfulness meditation.');\n  copingSuggestions.push('Take a short walk or engage in a relaxing activity.');\n}\nif (lowMood) {\n  copingSuggestions.push('Reach out to a trusted friend or family member.');\n  copingSuggestions.push('Engage in an enjoyable hobby or listen to uplifting music.');\n}\nif (copingSuggestions.length === 0) {\n  copingSuggestions.push('Keep practicing your regular self-care routines and stay hydrated.');\n}\n\nconst escalateAlert = overallScore < -0.7;\n\nreturn [{\n  json: {\n    sentimentSummary: sentiment,\n    copingSuggestions,\n    escalateAlert\n  }\n}];"
      },
      "name": "Analyze & Generate Suggestions",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1100,
        300
      ]
    },
    {
      "parameters": {
        "subject": "Your Daily Mental Wellness Check-In Results & Support",
        "text": "Hello,\n\nBased on your responses today, here are some personalized suggestions for you:\n\n{{$json.copingSuggestions.join('\\n- ')}}\n\nRemember to take care of yourself!\n\nIf you feel overwhelmed or need urgent help, please reach out to your support contacts.\n\nBest regards,\nYour Mental Wellness Support System",
        "toEmail": "={{$json.email || $json.userEmail || 'USER_EMAIL_PLACEHOLDER'}}",
        "options": {
          "noReply": true
        }
      },
      "name": "Send Personalized Support Email",
      "type": "n8n-nodes-base.smtp",
      "typeVersion": 1,
      "position": [
        1300,
        200
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.escalateAlert}}",
              "value2": true
            }
          ]
        }
      },
      "name": "Check Escalation Needed",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1300,
        400
      ]
    },
    {
      "parameters": {
        "subject": "URGENT: Mental Wellness Alert",
        "message": "The user has triggered an alert during their daily mental wellness check-in indicating potentially severe distress. Immediate support may be necessary.\n\nPlease reach out to them as soon as possible.\n\nThis message is generated by the Mental Wellness Support System.",
        "name": "Mental Wellness Support System",
        "toEmail": "support_contact@example.com"
      },
      "name": "Send Escalation Email",
      "type": "n8n-nodes-base.smtp",
      "typeVersion": 1,
      "position": [
        1500,
        400
      ]
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "summary",
        "model": "gpt-4o-mini",
        "inputText": "={{$json.combinedText}}",
        "options": {}
      },
      "name": "Summarize User Input",
      "type": "n8n-nodes-base.openai",
      "typeVersion": 1,
      "position": [
        900,
        450
      ]
    },
    {
      "parameters": {
        "functionCode": "const summary = $json.choices && $json.choices[0] && $json.choices[0].text ? $json.choices[0].text.trim() : '';\nreturn [{ json: { summary } }];"
      },
      "name": "Extract Summary Text",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        1100,
        450
      ]
    },
    {
      "parameters": {
        "path": "mental-wellness-data.json",
        "dataPropertyName": "data",
        "options": {}
      },
      "name": "Store Data Securely",
      "type": "n8n-nodes-base.writeBinaryFile",
      "typeVersion": 1,
      "position": [
        1300,
        500
      ]
    }
  ],
  "connections": {
    "Daily Trigger": {
      "main": [
        [
          {
            "node": "Mental Wellness Check-in Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mental Wellness Check-in Prompt": {
      "main": [
        [
          {
            "node": "Combine Responses",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Combine Responses": {
      "main": [
        [
          {
            "node": "AI Sentiment Analysis",
            "type": "main",
            "index": 0
          },
          {
            "node": "Summarize User Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Sentiment Analysis": {
      "main": [
        [
          {
            "node": "Analyze & Generate Suggestions",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze & Generate Suggestions": {
      "main": [
        [
          {
            "node": "Send Personalized Support Email",
            "type": "main",
            "index": 0
          },
          {
            "node": "Check Escalation Needed",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Escalation Needed": {
      "main": [
        [],
        [
          {
            "node": "Send Escalation Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summarize User Input": {
      "main": [
        [
          {
            "node": "Extract Summary Text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Summary Text": {
      "main": [
        [
          {
            "node": "Store Data Securely",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {},
  "id": "1"
}