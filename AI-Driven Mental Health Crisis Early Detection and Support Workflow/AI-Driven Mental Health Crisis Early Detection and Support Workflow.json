{
  "name": "AI-Powered Mental Health Crisis Early Warning and Support System",
  "nodes": [
    {
      "parameters": {
        "url": "https://api.socialmedia.com/v1/sentiment",
        "method": "GET",
        "queryParameters": [
          {
            "name": "keywords",
            "value": "mental health, crisis, stress, anxiety"
          },
          {
            "name": "time_range",
            "value": "last_1_hour"
          }
        ],
        "options": {}
      },
      "id": "1",
      "name": "Social Media Sentiment Analysis",
      "type": "httpRequest",
      "typeVersion": 1,
      "position": [
        250,
        150
      ]
    },
    {
      "parameters": {
        "resource": "sheet",
        "operation": "read",
        "sheetId": "user_self_reports_sheet_id",
        "range": "A2:D100",
        "options": {}
      },
      "id": "2",
      "name": "User Self-Reports",
      "type": "googleSheets",
      "typeVersion": 1,
      "position": [
        250,
        350
      ]
    },
    {
      "parameters": {
        "authentication": "oAuth2",
        "resource": "device",
        "operation": "getVitalSigns",
        "deviceIds": [
          "wearable_device_user_1",
          "wearable_device_user_2"
        ],
        "options": {
          "timeRange": "last_1_hour"
        }
      },
      "id": "3",
      "name": "Wearable Device Vitals",
      "type": "wearableApi",
      "typeVersion": 1,
      "position": [
        250,
        550
      ]
    },
    {
      "parameters": {
        "functionCode": "const socialSentiment = items[0].json.sentiment_score || 0;\nconst selfReports = items[1].json.data || [];\nconst vitals = items[2].json.vitals || [];\n\n// Aggregate self-report stress/anxiety levels\nconst avgSelfReportScore = selfReports.length > 0 ? selfReports.reduce((acc, r) => acc + (r.stress_level || 0), 0) / selfReports.length : 0;\n\n// Check vitals for abnormalities (e.g., elevated heart rate > 100, low HRV)\nconst abnormalVitals = vitals.some(v => v.heart_rate > 100 || v.hrv < 20);\n\n// Basic logic to detect early crisis risk\nconst crisisRiskScore = socialSentiment * 0.4 + avgSelfReportScore * 0.4 + (abnormalVitals ? 0.2 : 0);\n\nreturn [{ json: { crisisRiskScore, highRisk: crisisRiskScore > 0.7 } }];"
      },
      "id": "4",
      "name": "Risk Assessment Function",
      "type": "function",
      "typeVersion": 1,
      "position": [
        600,
        350
      ],
      "notesInFlow": true,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "rules": [
          {
            "value1": "={{$json[\"highRisk\"]}}",
            "operation": "equal",
            "value2": true
          }
        ]
      },
      "id": "5",
      "name": "Check High Risk",
      "type": "if",
      "typeVersion": 1,
      "position": [
        800,
        350
      ]
    },
    {
      "parameters": {
        "to": "={{$json[\"user_email\"]}}",
        "subject": "Immediate Mental Health Support",
        "text": "We detected early signs of mental health distress. Here are some personalized support resources and coping techniques.",
        "html": "<p>We detected early signs of mental health distress. Here are some personalized support resources and coping techniques.</p><ul><li><a href='https://mentalhealthsupport.example.com'>Mental Health Support Portal</a></li><li>Contact your caregiver or trusted contact immediately if you feel unsafe.</li><li>Professional resources: <a href='tel:1234567890'>Call 123-456-7890</a></li></ul>"
      },
      "id": "6",
      "name": "Send Support Message",
      "type": "emailSend",
      "typeVersion": 1,
      "position": [
        1050,
        250
      ]
    },
    {
      "parameters": {
        "to": "caregiver@example.com",
        "subject": "Alert: User at High Mental Health Risk",
        "text": "The system detected that the user is showing early signs of a mental health crisis. Please check in with them as soon as possible.",
        "html": "<p>The system detected that the user is showing early signs of a mental health crisis. Please check in with them as soon as possible.</p>"
      },
      "id": "7",
      "name": "Alert Caregiver",
      "type": "emailSend",
      "typeVersion": 1,
      "position": [
        1050,
        450
      ]
    },
    {
      "parameters": {
        "resource": "professional_resource",
        "operation": "search",
        "query": "mental health professional near user location",
        "options": {
          "limit": 3
        }
      },
      "id": "8",
      "name": "Suggest Professional Resources",
      "type": "externalApi",
      "typeVersion": 1,
      "position": [
        1050,
        550
      ]
    },
    {
      "parameters": {
        "functionCode": "const resources = items[0].json.resources || [];\nreturn [{ json: { resources } }];"
      },
      "id": "9",
      "name": "Format Professional Resources",
      "type": "function",
      "typeVersion": 1,
      "position": [
        1300,
        550
      ]
    },
    {
      "parameters": {
        "to": "={{$json[\"user_email\"]}}",
        "subject": "Professional Mental Health Resources",
        "text": "Here are some recommended professional mental health resources nearby:\n{{$json[\"resources\"].map(r => `- ${r.name}: ${r.contact}`).join('\\n')}}",
        "html": "<p>Here are some recommended professional mental health resources nearby:</p><ul>{{$json[\"resources\"].map(r => `<li>${r.name}: ${r.contact}</li>`).join('')}}</ul>"
      },
      "id": "10",
      "name": "Send Professional Resources",
      "type": "emailSend",
      "typeVersion": 1,
      "position": [
        1550,
        550
      ]
    }
  ],
  "connections": {
    "1": {
      "main": [
        [
          {
            "node": "4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2": {
      "main": [
        [
          {
            "node": "4",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "3": {
      "main": [
        [
          {
            "node": "4",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "4": {
      "main": [
        [
          {
            "node": "5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "5": {
      "main": [
        [
          {
            "node": "6",
            "type": "main",
            "index": 0
          },
          {
            "node": "7",
            "type": "main",
            "index": 0
          },
          {
            "node": "8",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "8": {
      "main": [
        [
          {
            "node": "9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "9": {
      "main": [
        [
          {
            "node": "10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "id": "mental_health_crisis_early_warning_workflow"
}